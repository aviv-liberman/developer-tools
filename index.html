<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Primary Meta Tags -->
    <title>Developer Tools - JSON Diff, Text Converter, URL Breakdown & Analytics</title>
    <meta name="title" content="Developer Tools - JSON Diff, Text Converter, URL Breakdown & Analytics">
    <meta name="description" content="Essential developer tools for JSON comparison, text case conversion, URL breakdown, and JSON analytics. Free online tools for developers.">
    <meta name="keywords" content="JSON diff, JSON comparison, text converter, case converter, URL breakdown, JSON analytics, developer tools, online tools">
    <meta name="author" content="Developer Tools">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="revisit-after" content="7 days">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://aviv-liberman.github.io/developer-tools/">
    <meta property="og:title" content="Developer Tools - JSON Diff, Text Converter, URL Breakdown & Analytics">
    <meta property="og:description" content="Essential developer tools for JSON comparison, text case conversion, URL breakdown, and JSON analytics. Free online tools for developers.">
    <meta property="og:image" content="https://aviv-liberman.github.io/developer-tools/favicon-192x192.png">
    <meta property="og:site_name" content="Developer Tools">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://aviv-liberman.github.io/developer-tools/">
    <meta property="twitter:title" content="Developer Tools - JSON Diff, Text Converter, URL Breakdown & Analytics">
    <meta property="twitter:description" content="Essential developer tools for JSON comparison, text case conversion, URL breakdown, and JSON analytics. Free online tools for developers.">
    <meta property="twitter:image" content="https://aviv-liberman.github.io/developer-tools/favicon-192x192.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="./favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="./favicon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="./favicon-512x512.png">
    <link rel="manifest" href="./site.webmanifest">
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#3B82F6">
    <meta name="msapplication-TileColor" content="#3B82F6">
    
    <!-- Security -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <!-- Performance -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    
    <!-- External Resources -->
    <script src="https://cdn.jsdelivr.net/npm/jsondiffpatch@0.4.1/dist/jsondiffpatch.umd.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jsondiffpatch@0.4.1/dist/formatters-styles/html.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Hide unchanged elements when toggle is active */
        .show-only-diffs .jsondiffpatch-unchanged {
            display: none !important;
        }
    </style>
</head>
<body class="m-0 p-5 font-sans bg-gray-100">
    <main class="max-w-6xl mx-auto bg-white p-5 rounded-lg shadow-lg">
        <header>
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Developer Tools</h1>
            <p class="text-gray-600 mb-8">Essential tools for developers - JSON comparison, text case conversion, URL breakdown, and JSON analytics.</p>
        </header>
        
        <!-- Tab Navigation -->
        <nav class="mb-8" role="tablist" aria-label="Developer Tools Navigation">
            <div class="border-b border-gray-200">
                <div class="-mb-px flex space-x-8">
                    <button id="json-tab" class="tab-button py-2 px-1 border-b-2 font-medium text-sm border-blue-500 text-blue-600" 
                            role="tab" aria-selected="true" aria-controls="json-tool" tabindex="0" onclick="switchTab('json')">
                        JSON Diff Tool
                    </button>
                    <button id="case-tab" class="tab-button py-2 px-1 border-b-2 font-medium text-sm hover:text-gray-700 border-transparent text-gray-500" 
                            role="tab" aria-selected="false" aria-controls="case-tool" tabindex="-1" onclick="switchTab('case')">
                        Text Case Converter
                    </button>
                    <button id="url-tab" class="tab-button py-2 px-1 border-b-2 font-medium text-sm hover:text-gray-700 border-transparent text-gray-500" 
                            role="tab" aria-selected="false" aria-controls="url-tool" tabindex="-1" onclick="switchTab('url')">
                        URL Breakdown
                    </button>
                    <button id="analytics-tab" class="tab-button py-2 px-1 border-b-2 font-medium text-sm hover:text-gray-700 border-transparent text-gray-500" 
                            role="tab" aria-selected="false" aria-controls="analytics-tool" tabindex="-1" onclick="switchTab('analytics')">
                        JSON Analytics
                    </button>
                </div>
            </div>
        </nav>
        
        <!-- JSON Diff Tool Tab -->
        <section id="json-tool" class="tab-content" role="tabpanel" aria-labelledby="json-tab" style="display: block;">
        
        <!-- Input Method Selection -->
        <div class="mb-8">
            <label for="input-method" class="block text-sm font-medium text-gray-700 mb-2">Choose Input Method:</label>
            <select id="input-method" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="toggleInputMethod()">
                <option value="paste">Paste JSON Content</option>
                <option value="files">Load JSON Files</option>
            </select>
        </div>

        <!-- File Upload Section -->
        <div id="file-upload-section" class="mb-8" style="display: none;">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Upload JSON Files</h2>
            <div class="flex gap-5 mb-8 flex-wrap">
                <div class="flex-1 min-w-80 p-5 border-2 border-dashed border-gray-300 rounded-lg text-center bg-gray-50 transition-colors duration-300 hover:border-blue-500" id="file1-upload">
                    <label for="file1" class="cursor-pointer text-blue-600 font-bold hover:text-blue-800">
                        Choose First JSON File<br>
                        <small class="text-gray-500">or drag and drop here</small>
                    </label>
                    <input type="file" id="file1" accept=".json" onchange="handleFileSelect(this, 'file1')" class="hidden">
                    <div class="mt-2 text-sm text-gray-600" id="file1-info"></div>
                </div>
                
                <div class="flex-1 min-w-80 p-5 border-2 border-dashed border-gray-300 rounded-lg text-center bg-gray-50 transition-colors duration-300 hover:border-blue-500" id="file2-upload">
                    <label for="file2" class="cursor-pointer text-blue-600 font-bold hover:text-blue-800">
                        Choose Second JSON File<br>
                        <small class="text-gray-500">or drag and drop here</small>
                    </label>
                    <input type="file" id="file2" accept=".json" onchange="handleFileSelect(this, 'file2')" class="hidden">
                    <div class="mt-2 text-sm text-gray-600" id="file2-info"></div>
                </div>
            </div>
        </div>

        <!-- JSON Paste Section -->
        <div id="json-paste-section" class="mb-8">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Paste JSON Content</h2>
            <div class="flex gap-5 mb-4 flex-wrap">
                <div class="flex-1 min-w-80">
                    <label for="json1" class="block text-sm font-medium text-gray-700 mb-2">First JSON:</label>
                    <textarea 
                        id="json1" 
                        placeholder="Paste your first JSON here..."
                        class="w-full h-40 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        onchange="handleJsonPaste('json1')"
                        onpaste="handleJsonPaste('json1')"
                    ></textarea>
                    <div class="mt-2 text-sm text-gray-600" id="json1-info"></div>
                </div>
                
                <div class="flex-1 min-w-80">
                    <label for="json2" class="block text-sm font-medium text-gray-700 mb-2">Second JSON:</label>
                    <textarea 
                        id="json2" 
                        placeholder="Paste your second JSON here..."
                        class="w-full h-40 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        onchange="handleJsonPaste('json2')"
                        onpaste="handleJsonPaste('json2')"
                    ></textarea>
                    <div class="mt-2 text-sm text-gray-600" id="json2-info"></div>
                </div>
            </div>
        </div>
        
        <button class="w-full py-4 bg-blue-600 text-white border-none rounded-lg text-base font-bold cursor-pointer my-5 transition-colors duration-300 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed" id="compare-btn" onclick="compareFiles()" disabled>
            Compare JSON Files
        </button>
        
        <div id="message-container"></div>
        <button class="bg-gray-600 text-white border-none py-2 px-5 rounded cursor-pointer my-2 text-sm hover:bg-gray-700 active:bg-blue-600" id="toggle-btn" onclick="toggleDiffView()" style="display: none;">
            Show Only Differences
        </button>
        <div id="diff-container"></div>
        </div>
        
        <!-- Text Case Converter Tab -->
        <section id="case-tool" class="tab-content" role="tabpanel" aria-labelledby="case-tab" style="display: none;">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">Text Case Converter</h2>
            <p class="text-gray-600 mb-6">Convert your text to different case formats. Click on any result to copy to clipboard.</p>
            
            <div class="mb-6">
                <label for="case-input" class="block text-sm font-medium text-gray-700 mb-2">Enter your text:</label>
                <textarea id="case-input" placeholder="Type or paste your text here..." class="w-full h-32 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" oninput="convertCases()"></textarea>
            </div>
            
            <div id="case-results" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="col-span-full text-center text-gray-500 italic">Enter some text to see case conversions</div>
            </div>
        </div>

        <!-- URL Breakdown Tab -->
        <section id="url-tool" class="tab-content" role="tabpanel" aria-labelledby="url-tab" style="display: none;">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">URL Breakdown</h2>
            <p class="text-gray-600 mb-6">Analyze and breakdown a URL into its components.</p>
            
                         <div class="mb-6">
                 <label for="url-input" class="block text-sm font-medium text-gray-700 mb-2">Enter a URL:</label>
                 <input type="url" id="url-input" placeholder="https://example.com/path/to/resource?query=value#fragment" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" oninput="breakdownURL()" onpaste="breakdownURL()">
                 <button onclick="breakdownURL()" class="mt-3 bg-blue-600 text-white border-none py-2 px-5 rounded cursor-pointer text-sm hover:bg-blue-700 active:bg-blue-800">
                     Breakdown URL
                 </button>
             </div>

            <div id="url-results" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Protocol</h3>
                    <p id="protocol-result" class="text-gray-900 font-mono text-sm break-all"></p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Host</h3>
                    <p id="host-result" class="text-gray-900 font-mono text-sm break-all"></p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Path</h3>
                    <p id="path-result" class="text-gray-900 font-mono text-sm break-all"></p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Query Parameters</h3>
                    <p id="query-result" class="text-gray-900 font-mono text-sm break-all"></p>
                </div>
                <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Fragment</h3>
                    <p id="fragment-result" class="text-gray-900 font-mono text-sm break-all"></p>
                </div>
            </div>
        </div>

        <!-- JSON Analytics Tab -->
        <section id="analytics-tool" class="tab-content" role="tabpanel" aria-labelledby="analytics-tab" style="display: none;">
            <h2 class="text-xl font-semibold text-gray-700 mb-4">JSON Analytics</h2>
            <p class="text-gray-600 mb-6">Analyze JSON structure, validate format, and get detailed insights about your JSON data.</p>
            
            <!-- Input Method Selection -->
            <div class="mb-6">
                <label for="analytics-input-method" class="block text-sm font-medium text-gray-700 mb-2">Choose Input Method:</label>
                <select id="analytics-input-method" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="toggleAnalyticsInputMethod()">
                    <option value="paste">Paste JSON Content</option>
                    <option value="file">Upload JSON File</option>
                </select>
            </div>

            <!-- File Upload Section -->
            <div id="analytics-file-section" class="mb-6" style="display: none;">
                <div class="p-6 border-2 border-dashed border-gray-300 rounded-lg text-center bg-gray-50 transition-colors duration-300 hover:border-blue-500" id="analytics-file-upload">
                    <label for="analytics-file" class="cursor-pointer text-blue-600 font-bold hover:text-blue-800">
                        <svg class="mx-auto mb-4 text-gray-400 w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        Choose JSON File<br>
                        <small class="text-gray-500">or drag and drop here</small>
                    </label>
                    <input type="file" id="analytics-file" accept=".json" onchange="handleAnalyticsFileSelect(this)" class="hidden">
                    <div class="mt-2 text-sm text-gray-600" id="analytics-file-info"></div>
                </div>
            </div>

            <!-- JSON Paste Section -->
            <div id="analytics-paste-section" class="mb-6">
                <label for="analytics-json" class="block text-sm font-medium text-gray-700 mb-2">Paste your JSON:</label>
                <textarea 
                    id="analytics-json" 
                    placeholder="Paste your JSON here..."
                    class="w-full h-40 p-3 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                    oninput="analyzeJSON()"
                ></textarea>
                <div class="mt-2 text-sm" id="analytics-json-info"></div>
            </div>

            <button class="w-full py-3 bg-green-600 text-white border-none rounded-lg text-base font-bold cursor-pointer mb-6 transition-colors duration-300 hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed" id="analyze-btn" onclick="analyzeJSON()" disabled>
                Analyze JSON
            </button>

            <!-- Results Section -->
            <div id="analytics-results" style="display: none;">
                <!-- Summary Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                    <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <h3 class="text-sm font-medium text-blue-700 mb-1">File Size</h3>
                        <p class="text-2xl font-bold text-blue-900" id="size-result">-</p>
                    </div>
                    <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                        <h3 class="text-sm font-medium text-green-700 mb-1">Keys Count</h3>
                        <p class="text-2xl font-bold text-green-900" id="keys-result">-</p>
                    </div>
                    <div class="bg-purple-50 p-4 rounded-lg border border-purple-200">
                        <h3 class="text-sm font-medium text-purple-700 mb-1">Max Depth</h3>
                        <p class="text-2xl font-bold text-purple-900" id="depth-result">-</p>
                    </div>
                    <div class="bg-orange-50 p-4 rounded-lg border border-orange-200">
                        <h3 class="text-sm font-medium text-orange-700 mb-1">Data Types</h3>
                        <p class="text-2xl font-bold text-orange-900" id="types-result">-</p>
                    </div>
                </div>

                <!-- Detailed Analysis Tabs -->
                <div class="border border-gray-200 rounded-lg">
                    <div class="border-b border-gray-200">
                        <nav class="flex">
                            <button id="structure-tab" class="analytics-tab px-6 py-3 text-sm font-medium border-b-2 border-blue-500 text-blue-600" onclick="switchAnalyticsTab('structure')">
                                Structure
                            </button>
                            <button id="schema-tab" class="analytics-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700" onclick="switchAnalyticsTab('schema')">
                                Schema
                            </button>
                            <button id="validation-tab" class="analytics-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700" onclick="switchAnalyticsTab('validation')">
                                Validation
                            </button>
                            <button id="formatted-tab" class="analytics-tab px-6 py-3 text-sm font-medium border-b-2 border-transparent text-gray-500 hover:text-gray-700" onclick="switchAnalyticsTab('formatted')">
                                Formatted
                            </button>
                        </nav>
                    </div>
                    
                    <!-- Structure Tab -->
                    <div id="structure-content" class="analytics-tab-content p-6" style="display: block;">
                        <div id="structure-tree"></div>
                    </div>
                    
                    <!-- Schema Tab -->
                    <div id="schema-content" class="analytics-tab-content p-6" style="display: none;">
                        <div id="schema-info"></div>
                    </div>
                    
                    <!-- Validation Tab -->
                    <div id="validation-content" class="analytics-tab-content p-6" style="display: none;">
                        <div id="validation-info"></div>
                    </div>
                    
                    <!-- Formatted Tab -->
                    <div id="formatted-content" class="analytics-tab-content p-6" style="display: none;">
                        <div class="mb-4">
                            <button onclick="copyFormattedJSON()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition-colors">
                                Copy Formatted JSON
                            </button>
                        </div>
                        <pre id="formatted-json" class="bg-gray-100 p-4 rounded border overflow-auto max-h-96 text-sm"></pre>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        let file1Data = null;
        let file2Data = null;
        let json1Data = null;
        let json2Data = null;
        let isShowingOnlyDiffs = false;
        let currentInputMethod = 'paste';
        
        // Analytics variables
        let analyticsData = null;
        let currentAnalyticsInputMethod = 'paste';

        // Analytics functions
        function toggleAnalyticsInputMethod() {
            const method = document.getElementById('analytics-input-method').value;
            const fileSection = document.getElementById('analytics-file-section');
            const pasteSection = document.getElementById('analytics-paste-section');
            
            currentAnalyticsInputMethod = method;
            
            if (method === 'file') {
                fileSection.style.display = 'block';
                pasteSection.style.display = 'none';
                // Clear paste data
                document.getElementById('analytics-json').value = '';
                document.getElementById('analytics-json-info').innerHTML = '';
            } else {
                fileSection.style.display = 'none';
                pasteSection.style.display = 'block';
                // Clear file data
                document.getElementById('analytics-file').value = '';
                document.getElementById('analytics-file-info').innerHTML = '';
            }
            
            analyticsData = null;
            updateAnalyzeButton();
            hideAnalyticsResults();
        }

        function handleAnalyticsFileSelect(input) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        analyticsData = JSON.parse(e.target.result);
                        document.getElementById('analytics-file-info').innerHTML = 
                            `<strong>${file.name}</strong><br>Size: ${(file.size / 1024).toFixed(1)} KB<br><span class="text-green-600">✓ Valid JSON</span>`;
                        updateAnalyzeButton();
                        analyzeJSON();
                    } catch (error) {
                        showMessage(`Error parsing ${file.name}: ${error.message}`, 'error');
                        document.getElementById('analytics-file-info').innerHTML = 
                            `<strong>${file.name}</strong><br><span class="text-red-600">✗ Invalid JSON: ${error.message}</span>`;
                        analyticsData = null;
                        updateAnalyzeButton();
                        hideAnalyticsResults();
                    }
                };
                reader.readAsText(file);
            }
        }

        function updateAnalyzeButton() {
            const analyzeBtn = document.getElementById('analyze-btn');
            analyzeBtn.disabled = !analyticsData;
        }

        function hideAnalyticsResults() {
            document.getElementById('analytics-results').style.display = 'none';
        }

        function analyzeJSON() {
            if (currentAnalyticsInputMethod === 'paste') {
                const content = document.getElementById('analytics-json').value.trim();
                const infoDiv = document.getElementById('analytics-json-info');
                
                if (!content) {
                    analyticsData = null;
                    infoDiv.innerHTML = '';
                    updateAnalyzeButton();
                    hideAnalyticsResults();
                    return;
                }
                
                try {
                    analyticsData = JSON.parse(content);
                    infoDiv.innerHTML = '<span class="text-green-600">✓ Valid JSON</span>';
                } catch (error) {
                    analyticsData = null;
                    infoDiv.innerHTML = `<span class="text-red-600">✗ Invalid JSON: ${error.message}</span>`;
                    updateAnalyzeButton();
                    hideAnalyticsResults();
                    return;
                }
            }
            
            if (!analyticsData) {
                return;
            }
            
            updateAnalyzeButton();
            performAnalysis();
        }

        function performAnalysis() {
            const jsonString = JSON.stringify(analyticsData);
            const analysis = analyzeJSONStructure(analyticsData);
            
            // Update summary cards
            document.getElementById('size-result').textContent = formatBytes(new Blob([jsonString]).size);
            document.getElementById('keys-result').textContent = analysis.totalKeys.toString();
            document.getElementById('depth-result').textContent = analysis.maxDepth.toString();
            document.getElementById('types-result').textContent = Object.keys(analysis.dataTypes).length.toString();
            
            // Update detailed analysis tabs
            updateStructureTab(analysis);
            updateSchemaTab(analysis);
            updateValidationTab(analysis);
            updateFormattedTab(jsonString);
            
            // Show results
            document.getElementById('analytics-results').style.display = 'block';
            
            showMessage('JSON analysis complete!', 'success');
        }

        function analyzeJSONStructure(obj, path = '', depth = 0) {
            const analysis = {
                maxDepth: depth,
                totalKeys: 0,
                dataTypes: {},
                structure: [],
                paths: [],
                arrays: [],
                objects: []
            };
            
            if (obj === null) {
                analysis.dataTypes.null = (analysis.dataTypes.null || 0) + 1;
                return analysis;
            }
            
            const type = Array.isArray(obj) ? 'array' : typeof obj;
            analysis.dataTypes[type] = (analysis.dataTypes[type] || 0) + 1;
            
            if (type === 'object') {
                analysis.objects.push({ path, keys: Object.keys(obj).length });
                Object.keys(obj).forEach(key => {
                    analysis.totalKeys++;
                    const newPath = path ? `${path}.${key}` : key;
                    analysis.paths.push({ path: newPath, type: typeof obj[key] });
                    
                    const childAnalysis = analyzeJSONStructure(obj[key], newPath, depth + 1);
                    analysis.maxDepth = Math.max(analysis.maxDepth, childAnalysis.maxDepth);
                    analysis.totalKeys += childAnalysis.totalKeys;
                    
                    // Merge data types
                    Object.keys(childAnalysis.dataTypes).forEach(t => {
                        analysis.dataTypes[t] = (analysis.dataTypes[t] || 0) + childAnalysis.dataTypes[t];
                    });
                    
                    analysis.paths.push(...childAnalysis.paths);
                    analysis.arrays.push(...childAnalysis.arrays);
                    analysis.objects.push(...childAnalysis.objects);
                });
            } else if (type === 'array') {
                analysis.arrays.push({ path, length: obj.length });
                obj.forEach((item, index) => {
                    const newPath = `${path}[${index}]`;
                    const childAnalysis = analyzeJSONStructure(item, newPath, depth + 1);
                    analysis.maxDepth = Math.max(analysis.maxDepth, childAnalysis.maxDepth);
                    analysis.totalKeys += childAnalysis.totalKeys;
                    
                    // Merge data types
                    Object.keys(childAnalysis.dataTypes).forEach(t => {
                        analysis.dataTypes[t] = (analysis.dataTypes[t] || 0) + childAnalysis.dataTypes[t];
                    });
                    
                    analysis.paths.push(...childAnalysis.paths);
                    analysis.arrays.push(...childAnalysis.arrays);
                    analysis.objects.push(...childAnalysis.objects);
                });
            }
            
            return analysis;
        }

        function switchAnalyticsTab(tabName) {
            // Remove active state from all analytics tab buttons
            const tabButtons = document.querySelectorAll('.analytics-tab');
            tabButtons.forEach(button => {
                button.classList.remove('border-blue-500', 'text-blue-600');
                button.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Hide all analytics tab contents
            const tabContents = document.querySelectorAll('.analytics-tab-content');
            tabContents.forEach(content => {
                content.style.display = 'none';
            });
            
            // Show selected tab content
            const selectedContent = document.getElementById(tabName + '-content');
            if (selectedContent) {
                selectedContent.style.display = 'block';
            }
            
            // Activate selected tab button
            const selectedButton = document.getElementById(tabName + '-tab');
            if (selectedButton) {
                selectedButton.classList.remove('border-transparent', 'text-gray-500');
                selectedButton.classList.add('border-blue-500', 'text-blue-600');
            }
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function updateStructureTab(analysis) {
            const container = document.getElementById('structure-tree');
            let html = '<div class="space-y-4">';
            
            // Data Types Summary
            html += '<div class="bg-gray-50 p-4 rounded border">';
            html += '<h4 class="font-semibold text-gray-700 mb-3">Data Types Distribution</h4>';
            html += '<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2">';
            Object.entries(analysis.dataTypes).forEach(([type, count]) => {
                const color = getTypeColor(type);
                html += `
                    <div class="bg-white p-2 rounded border ${color} text-center">
                        <div class="font-medium text-sm">${type}</div>
                        <div class="text-lg font-bold">${count}</div>
                    </div>
                `;
            });
            html += '</div></div>';
            
            // Arrays Summary
            if (analysis.arrays.length > 0) {
                html += '<div class="bg-blue-50 p-4 rounded border border-blue-200">';
                html += '<h4 class="font-semibold text-blue-700 mb-3">Arrays Found</h4>';
                analysis.arrays.slice(0, 10).forEach(arr => {
                    html += `<div class="text-sm mb-1"><code class="bg-blue-100 px-2 py-1 rounded">${arr.path || 'root'}</code> - ${arr.length} items</div>`;
                });
                if (analysis.arrays.length > 10) {
                    html += `<div class="text-sm text-blue-600 mt-2">... and ${analysis.arrays.length - 10} more arrays</div>`;
                }
                html += '</div>';
            }
            
            // Objects Summary
            if (analysis.objects.length > 0) {
                html += '<div class="bg-green-50 p-4 rounded border border-green-200">';
                html += '<h4 class="font-semibold text-green-700 mb-3">Objects Found</h4>';
                analysis.objects.slice(0, 10).forEach(obj => {
                    html += `<div class="text-sm mb-1"><code class="bg-green-100 px-2 py-1 rounded">${obj.path || 'root'}</code> - ${obj.keys} keys</div>`;
                });
                if (analysis.objects.length > 10) {
                    html += `<div class="text-sm text-green-600 mt-2">... and ${analysis.objects.length - 10} more objects</div>`;
                }
                html += '</div>';
            }
            
            html += '</div>';
            container.innerHTML = html;
        }

        function updateSchemaTab(analysis) {
            const container = document.getElementById('schema-info');
            const schema = generateJSONSchema(analyticsData);
            
            let html = '<div class="space-y-4">';
            html += '<div class="bg-gray-50 p-4 rounded border">';
            html += '<h4 class="font-semibold text-gray-700 mb-3">Generated Schema</h4>';
            html += '<div class="mb-4">';
            html += '<button onclick="copyToClipboard(JSON.stringify(' + JSON.stringify(schema) + ', null, 2), \'JSON Schema\')" class="bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 transition-colors">';
            html += 'Copy Schema';
            html += '</button>';
            html += '</div>';
            html += '<pre class="bg-white p-4 rounded border overflow-auto max-h-64 text-sm">' + JSON.stringify(schema, null, 2) + '</pre>';
            html += '</div>';
            html += '</div>';
            
            container.innerHTML = html;
        }

        function updateValidationTab(analysis) {
            const container = document.getElementById('validation-info');
            const validation = validateJSONStructure(analyticsData);
            
            let html = '<div class="space-y-4">';
            
            // Validation Status
            html += `<div class="p-4 rounded border ${validation.isValid ? 'bg-green-50 border-green-200' : 'bg-red-50 border-red-200'}">`;
            html += `<h4 class="font-semibold ${validation.isValid ? 'text-green-700' : 'text-red-700'} mb-2">`;
            html += `${validation.isValid ? '✓ Valid JSON' : '✗ Issues Found'}`;
            html += '</h4>';
            
            if (validation.warnings.length > 0) {
                html += '<div class="mt-3">';
                html += '<h5 class="font-medium text-yellow-700 mb-2">Warnings:</h5>';
                validation.warnings.forEach(warning => {
                    html += `<div class="text-sm text-yellow-600 mb-1">• ${warning}</div>`;
                });
                html += '</div>';
            }
            
            if (validation.suggestions.length > 0) {
                html += '<div class="mt-3">';
                html += '<h5 class="font-medium text-blue-700 mb-2">Suggestions:</h5>';
                validation.suggestions.forEach(suggestion => {
                    html += `<div class="text-sm text-blue-600 mb-1">• ${suggestion}</div>`;
                });
                html += '</div>';
            }
            
            html += '</div>';
            
            // Statistics
            html += '<div class="bg-gray-50 p-4 rounded border">';
            html += '<h4 class="font-semibold text-gray-700 mb-3">Statistics</h4>';
            html += '<div class="grid grid-cols-2 gap-4 text-sm">';
            html += `<div><strong>Total Keys:</strong> ${analysis.totalKeys}</div>`;
            html += `<div><strong>Max Depth:</strong> ${analysis.maxDepth}</div>`;
            html += `<div><strong>Arrays:</strong> ${analysis.arrays.length}</div>`;
            html += `<div><strong>Objects:</strong> ${analysis.objects.length}</div>`;
            html += '</div>';
            html += '</div>';
            
            html += '</div>';
            container.innerHTML = html;
        }

        function updateFormattedTab(jsonString) {
            const container = document.getElementById('formatted-json');
            container.textContent = JSON.stringify(analyticsData, null, 2);
        }

        function copyFormattedJSON() {
            const formattedJson = JSON.stringify(analyticsData, null, 2);
            copyToClipboard(formattedJson, 'Formatted JSON');
        }

        function getTypeColor(type) {
            const colors = {
                'string': 'text-blue-600 bg-blue-50',
                'number': 'text-green-600 bg-green-50',
                'boolean': 'text-purple-600 bg-purple-50',
                'object': 'text-orange-600 bg-orange-50',
                'array': 'text-red-600 bg-red-50',
                'null': 'text-gray-600 bg-gray-50',
                'undefined': 'text-gray-600 bg-gray-50'
            };
            return colors[type] || 'text-gray-600 bg-gray-50';
        }

        function generateJSONSchema(obj) {
            if (obj === null) return { type: 'null' };
            
            const type = Array.isArray(obj) ? 'array' : typeof obj;
            
            switch (type) {
                case 'object':
                    const schema = {
                        type: 'object',
                        properties: {},
                        required: []
                    };
                    
                    Object.keys(obj).forEach(key => {
                        schema.properties[key] = generateJSONSchema(obj[key]);
                        schema.required.push(key);
                    });
                    
                    return schema;
                
                case 'array':
                    const arraySchema = { type: 'array' };
                    if (obj.length > 0) {
                        // Generate schema for first item as example
                        arraySchema.items = generateJSONSchema(obj[0]);
                    }
                    return arraySchema;
                
                case 'string':
                    return { type: 'string' };
                
                case 'number':
                    return { type: 'number' };
                
                case 'boolean':
                    return { type: 'boolean' };
                
                default:
                    return { type: type };
            }
        }

        function validateJSONStructure(obj) {
            const validation = {
                isValid: true,
                warnings: [],
                suggestions: []
            };
            
            // Check for common issues
            checkForLargeArrays(obj, validation);
            checkForDeepNesting(obj, validation, 0);
            checkForEmptyObjects(obj, validation);
            checkForInconsistentArrays(obj, validation);
            
            return validation;
        }

        function checkForLargeArrays(obj, validation, path = '') {
            if (Array.isArray(obj) && obj.length > 1000) {
                validation.warnings.push(`Large array at ${path || 'root'} with ${obj.length} items`);
                validation.suggestions.push(`Consider paginating large arrays at ${path || 'root'}`);
            }
            
            if (typeof obj === 'object' && obj !== null) {
                Object.keys(obj).forEach(key => {
                    const newPath = path ? `${path}.${key}` : key;
                    checkForLargeArrays(obj[key], validation, newPath);
                });
            }
        }

        function checkForDeepNesting(obj, validation, depth, path = '') {
            if (depth > 10) {
                validation.warnings.push(`Deep nesting (${depth} levels) at ${path || 'root'}`);
                validation.suggestions.push(`Consider flattening deeply nested structures at ${path || 'root'}`);
            }
            
            if (typeof obj === 'object' && obj !== null && !Array.isArray(obj)) {
                Object.keys(obj).forEach(key => {
                    const newPath = path ? `${path}.${key}` : key;
                    checkForDeepNesting(obj[key], validation, depth + 1, newPath);
                });
            } else if (Array.isArray(obj)) {
                obj.forEach((item, index) => {
                    const newPath = `${path}[${index}]`;
                    checkForDeepNesting(item, validation, depth + 1, newPath);
                });
            }
        }

        function checkForEmptyObjects(obj, validation, path = '') {
            if (typeof obj === 'object' && obj !== null && !Array.isArray(obj) && Object.keys(obj).length === 0) {
                validation.warnings.push(`Empty object at ${path || 'root'}`);
            }
            
            if (typeof obj === 'object' && obj !== null) {
                if (Array.isArray(obj)) {
                    obj.forEach((item, index) => {
                        const newPath = `${path}[${index}]`;
                        checkForEmptyObjects(item, validation, newPath);
                    });
                } else {
                    Object.keys(obj).forEach(key => {
                        const newPath = path ? `${path}.${key}` : key;
                        checkForEmptyObjects(obj[key], validation, newPath);
                    });
                }
            }
        }

        function checkForInconsistentArrays(obj, validation, path = '') {
            if (Array.isArray(obj) && obj.length > 1) {
                const firstType = typeof obj[0];
                const hasInconsistentTypes = obj.some(item => typeof item !== firstType);
                
                if (hasInconsistentTypes) {
                    validation.warnings.push(`Inconsistent array types at ${path || 'root'}`);
                    validation.suggestions.push(`Consider using consistent data types in arrays at ${path || 'root'}`);
                }
            }
            
            if (typeof obj === 'object' && obj !== null) {
                if (Array.isArray(obj)) {
                    obj.forEach((item, index) => {
                        const newPath = `${path}[${index}]`;
                        checkForInconsistentArrays(item, validation, newPath);
                    });
                } else {
                    Object.keys(obj).forEach(key => {
                        const newPath = path ? `${path}.${key}` : key;
                        checkForInconsistentArrays(obj[key], validation, newPath);
                    });
                }
            }
        }

        function setupAnalyticsDragAndDrop() {
            const upload = document.getElementById('analytics-file-upload');
            
            upload.addEventListener('dragover', (e) => {
                e.preventDefault();
                upload.classList.add('border-blue-500', 'bg-blue-50');
            });
            
            upload.addEventListener('dragleave', (e) => {
                e.preventDefault();
                upload.classList.remove('border-blue-500', 'bg-blue-50');
            });
            
            upload.addEventListener('drop', (e) => {
                e.preventDefault();
                upload.classList.remove('border-blue-500', 'bg-blue-50');
                
                const files = e.dataTransfer.files;
                if (files.length > 0) {
                    const file = files[0];
                    if (file.type === 'application/json' || file.name.endsWith('.json')) {
                        const input = document.getElementById('analytics-file');
                        
                        const dataTransfer = new DataTransfer();
                        dataTransfer.items.add(file);
                        input.files = dataTransfer.files;
                        
                        handleAnalyticsFileSelect(input);
                    } else {
                        showMessage('Please select a JSON file', 'error');
                    }
                }
            });
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.style.display = 'none';
            });
            
            // Remove active state from all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('border-blue-500', 'text-blue-600');
                button.classList.add('border-transparent', 'text-gray-500');
                button.setAttribute('aria-selected', 'false');
                button.setAttribute('tabindex', '-1');
            });
            
            // Show selected tab content
            const selectedContent = document.getElementById(tabName + '-tool');
            if (selectedContent) {
                selectedContent.style.display = 'block';
            }
            
            // Activate selected tab button
            const selectedButton = document.getElementById(tabName + '-tab');
            if (selectedButton) {
                selectedButton.classList.remove('border-transparent', 'text-gray-500');
                selectedButton.classList.add('border-blue-500', 'text-blue-600');
                selectedButton.setAttribute('aria-selected', 'true');
                selectedButton.setAttribute('tabindex', '0');
            }
        }

        // Case conversion functionality
        function convertCases() {
            const input = document.getElementById('case-input').value;
            const resultsContainer = document.getElementById('case-results');
            
            if (!input.trim()) {
                resultsContainer.innerHTML = '<div class="col-span-full text-center text-gray-500 italic">Enter some text to see case conversions</div>';
                return;
            }
            
            const cases = [
                { name: 'camelCase', convert: toCamelCase },
                { name: 'PascalCase', convert: toPascalCase },
                { name: 'snake_case', convert: toSnakeCase },
                { name: 'kebab-case', convert: toKebabCase },
                { name: 'UPPER_SNAKE_CASE', convert: toUpperSnakeCase },
                { name: 'UPPER CASE', convert: toUpperCase },
                { name: 'lower case', convert: toLowerCase },
                { name: 'Title Case', convert: toTitleCase },
                { name: 'Sentence case', convert: toSentenceCase },
                { name: 'dot.case', convert: toDotCase },
                { name: 'path/case', convert: toPathCase },
                { name: 'Header-Case', convert: toHeaderCase },
                { name: 'no case', convert: toNoCase },
                { name: 'swap case', convert: toSwapCase }
            ];
            
            const resultsHTML = cases.map(caseType => {
                try {
                    const converted = caseType.convert(input);
                    return `
                        <div class="bg-gray-50 p-4 rounded-lg border hover:border-blue-300 transition-colors cursor-pointer" 
                             onclick="copyToClipboard('${converted.replace(/'/g, "\\'")}', '${caseType.name}')">
                            <div class="text-sm font-medium text-gray-700 mb-2">${caseType.name}</div>
                            <div class="text-gray-900 font-mono text-sm break-all">${converted}</div>
                            <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                        </div>
                    `;
                } catch (error) {
                    return `
                        <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                            <div class="text-sm font-medium text-red-700 mb-2">${caseType.name}</div>
                            <div class="text-red-600 text-sm">Error: ${error.message}</div>
                        </div>
                    `;
                }
            }).join('');
            
            resultsContainer.innerHTML = resultsHTML;
        }

        // Robust case conversion functions that work with any input case
        function splitIntoWords(str) {
            // Handle various separators and case changes
            return str
                .replace(/([a-z])([A-Z])/g, '$1 $2') // camelCase -> camel Case
                .replace(/([A-Z])([A-Z][a-z])/g, '$1 $2') // HTML -> H TML
                .replace(/[_\-\s]+/g, ' ') // Replace separators with spaces
                .trim()
                .split(/\s+/)
                .filter(word => word.length > 0);
        }

        function toCamelCase(str) {
            const words = splitIntoWords(str);
            return words.map((word, index) => {
                const lower = word.toLowerCase();
                return index === 0 ? lower : lower.charAt(0).toUpperCase() + lower.slice(1);
            }).join('');
        }

        function toPascalCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => {
                const lower = word.toLowerCase();
                return lower.charAt(0).toUpperCase() + lower.slice(1);
            }).join('');
        }

        function toSnakeCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => word.toLowerCase()).join('_');
        }

        function toKebabCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => word.toLowerCase()).join('-');
        }

        function toUpperSnakeCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => word.toUpperCase()).join('_');
        }

        function toUpperCase(str) {
            return str.toUpperCase();
        }

        function toLowerCase(str) {
            return str.toLowerCase();
        }

        function toTitleCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => {
                const lower = word.toLowerCase();
                return lower.charAt(0).toUpperCase() + lower.slice(1);
            }).join(' ');
        }

        function toSentenceCase(str) {
            const words = splitIntoWords(str);
            if (words.length === 0) return str;
            
            return words.map((word, index) => {
                const lower = word.toLowerCase();
                if (index === 0) {
                    return lower.charAt(0).toUpperCase() + lower.slice(1);
                }
                return lower;
            }).join(' ');
        }

        function toDotCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => word.toLowerCase()).join('.');
        }

        function toPathCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => word.toLowerCase()).join('/');
        }

        function toHeaderCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => {
                const lower = word.toLowerCase();
                return lower.charAt(0).toUpperCase() + lower.slice(1);
            }).join('-');
        }

        function toNoCase(str) {
            const words = splitIntoWords(str);
            return words.map(word => word.toLowerCase()).join(' ');
        }

        function toSwapCase(str) {
            return str.split('').map(char => {
                if (char === char.toUpperCase()) {
                    return char.toLowerCase();
                } else {
                    return char.toUpperCase();
                }
            }).join('');
        }

        // Copy to clipboard functionality
        function copyToClipboard(text, caseType) {
            navigator.clipboard.writeText(text).then(() => {
                showMessage(`"${caseType}" copied to clipboard!`, 'success');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showMessage('Failed to copy to clipboard', 'error');
            });
        }

        // Toggle input method
        function toggleInputMethod() {
            const method = document.getElementById('input-method').value;
            const fileSection = document.getElementById('file-upload-section');
            const pasteSection = document.getElementById('json-paste-section');
            
            currentInputMethod = method;
            
            if (method === 'files') {
                fileSection.style.display = 'block';
                pasteSection.style.display = 'none';
                // Clear paste data when switching to files
                json1Data = null;
                json2Data = null;
                document.getElementById('json1').value = '';
                document.getElementById('json2').value = '';
                document.getElementById('json1-info').innerHTML = '';
                document.getElementById('json2-info').innerHTML = '';
            } else {
                fileSection.style.display = 'none';
                pasteSection.style.display = 'block';
                // Clear file data when switching to paste
                file1Data = null;
                file2Data = null;
                document.getElementById('file1').value = '';
                document.getElementById('file2').value = '';
                document.getElementById('file1-info').innerHTML = '';
                document.getElementById('file2-info').innerHTML = '';
            }
            
            updateCompareButton();
        }

        // File selection handler
        function handleFileSelect(input, fileId) {
            const file = input.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const jsonData = JSON.parse(e.target.result);
                        if (fileId === 'file1') {
                            file1Data = jsonData;
                        } else {
                            file2Data = jsonData;
                        }
                        
                        // Update file info
                        document.getElementById(`${fileId}-info`).innerHTML = 
                            `<strong>${file.name}</strong><br>Size: ${(file.size / 1024).toFixed(1)} KB`;
                        
                        updateCompareButton();
                    } catch (error) {
                        showMessage(`Error parsing ${file.name}: ${error.message}`, 'error');
                        document.getElementById(`${fileId}-info`).innerHTML = '';
                        if (fileId === 'file1') {
                            file1Data = null;
                        } else {
                            file2Data = null;
                        }
                        updateCompareButton();
                    }
                };
                reader.readAsText(file);
            }
        }

        // JSON paste handler
        function handleJsonPaste(textareaId) {
            const textarea = document.getElementById(textareaId);
            const content = textarea.value.trim();
            
            if (!content) {
                if (textareaId === 'json1') {
                    json1Data = null;
                    document.getElementById('json1-info').innerHTML = '';
                } else {
                    json2Data = null;
                    document.getElementById('json2-info').innerHTML = '';
                }
                updateCompareButton();
                return;
            }
            
            try {
                const jsonData = JSON.parse(content);
                if (textareaId === 'json1') {
                    json1Data = jsonData;
                    document.getElementById('json1-info').innerHTML = '<span class="text-green-600">✓ Valid JSON</span>';
                } else {
                    json2Data = jsonData;
                    document.getElementById('json2-info').innerHTML = '<span class="text-green-600">✓ Valid JSON</span>';
                }
                updateCompareButton();
            } catch (error) {
                if (textareaId === 'json1') {
                    json1Data = null;
                    document.getElementById('json1-info').innerHTML = `<span class="text-red-600">✗ Invalid JSON: ${error.message}</span>`;
                } else {
                    json2Data = null;
                    document.getElementById('json2-info').innerHTML = `<span class="text-red-600">✗ Invalid JSON: ${error.message}</span>`;
                }
                updateCompareButton();
            }
        }

        // Update compare button state
        function updateCompareButton() {
            const compareBtn = document.getElementById('compare-btn');
            let hasFirstData, hasSecondData;
            
            if (currentInputMethod === 'files') {
                hasFirstData = file1Data;
                hasSecondData = file2Data;
            } else {
                hasFirstData = json1Data;
                hasSecondData = json2Data;
            }
            
            compareBtn.disabled = !(hasFirstData && hasSecondData);
        }

        // Drag and drop functionality
        function setupDragAndDrop() {
            const uploads = document.querySelectorAll('#file1-upload, #file2-upload');
            
            uploads.forEach(upload => {
                upload.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    upload.classList.add('border-blue-500', 'bg-blue-50');
                });
                
                upload.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    upload.classList.remove('border-blue-500', 'bg-blue-50');
                });
                
                upload.addEventListener('drop', (e) => {
                    e.preventDefault();
                    upload.classList.remove('border-blue-500', 'bg-blue-50');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const file = files[0];
                        if (file.type === 'application/json' || file.name.endsWith('.json')) {
                            const fileId = upload.id.replace('-upload', '');
                            const input = document.getElementById(fileId);
                            
                            // Create a new FileList-like object
                            const dataTransfer = new DataTransfer();
                            dataTransfer.items.add(file);
                            input.files = dataTransfer.files;
                            
                            handleFileSelect(input, fileId);
                        } else {
                            showMessage('Please select a JSON file', 'error');
                        }
                    }
                });
            });
        }

        // Show message
        function showMessage(message, type = 'info') {
            const container = document.getElementById('message-container');
            let bgColor, textColor;
            
            switch(type) {
                case 'error':
                    bgColor = 'bg-red-100';
                    textColor = 'text-red-800';
                    break;
                case 'success':
                    bgColor = 'bg-green-100';
                    textColor = 'text-green-800';
                    break;
                default:
                    bgColor = 'bg-blue-100';
                    textColor = 'text-blue-800';
            }
            
            container.innerHTML = `<div class="${bgColor} ${textColor} text-center p-5 rounded my-2">${message}</div>`;
        }

        // Clear message
        function clearMessage() {
            document.getElementById('message-container').innerHTML = '';
        }

        // Toggle diff view
        function toggleDiffView() {
            const toggleBtn = document.getElementById('toggle-btn');
            const diffContainer = document.getElementById('diff-container');
            
            isShowingOnlyDiffs = !isShowingOnlyDiffs;
            
            if (isShowingOnlyDiffs) {
                diffContainer.classList.add('show-only-diffs');
                toggleBtn.textContent = 'Show All';
                toggleBtn.classList.add('bg-blue-600');
            } else {
                diffContainer.classList.remove('show-only-diffs');
                toggleBtn.textContent = 'Show Only Differences';
                toggleBtn.classList.remove('bg-blue-600');
            }
        }

        // Compare files
        function compareFiles() {
            let firstData, secondData;
            
            if (currentInputMethod === 'files') {
                firstData = file1Data;
                secondData = file2Data;
            } else {
                firstData = json1Data;
                secondData = json2Data;
            }
            
            if (!firstData || !secondData) {
                const methodText = currentInputMethod === 'files' ? 'upload JSON files' : 'paste JSON content';
                showMessage(`Please ${methodText}`, 'error');
                return;
            }

            clearMessage();
            
            try {
                // Wait for jsondiffpatch to be available
                if (typeof window.jsondiffpatch === 'undefined') {
                    throw new Error('jsondiffpatch library not loaded');
                }

                // Generate diff using jsondiffpatch
                const instance = jsondiffpatch.create();
                const delta = instance.diff(firstData, secondData);
                
                const diffContainer = document.getElementById('diff-container');
                const toggleBtn = document.getElementById('toggle-btn');
                
                // Display the diff using jsondiffpatch's HTML formatter
                if (delta) {
                    const formattersHtml = jsondiffpatch.formatters.html;
                    const html = formattersHtml.format(delta, firstData);
                    diffContainer.innerHTML = html;
                    
                    // Show toggle button
                    toggleBtn.style.display = 'inline-block';
                    
                    // Reset toggle state
                    isShowingOnlyDiffs = false;
                    diffContainer.classList.remove('show-only-diffs');
                    toggleBtn.textContent = 'Show Only Differences';
                    toggleBtn.classList.remove('bg-blue-600');
                    
                    showMessage('Differences found and displayed below', 'success');
                } else {
                    diffContainer.innerHTML = '<div class="text-center p-10 text-gray-600 italic">No differences found between the JSON files</div>';
                    toggleBtn.style.display = 'none';
                    showMessage('No differences found between the JSON files', 'success');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage(`Error comparing files: ${error.message}`, 'error');
                document.getElementById('diff-container').innerHTML = '';
                document.getElementById('toggle-btn').style.display = 'none';
            }
        }

        // URL Breakdown functionality
        function breakdownURL() {
            const urlInput = document.getElementById('url-input').value;
            const resultsContainer = document.getElementById('url-results');
            
            if (!urlInput.trim()) {
                resultsContainer.innerHTML = '<div class="col-span-full text-center text-gray-500 italic">Enter a URL to breakdown</div>';
                return;
            }

            try {
                // Add protocol if missing
                let processedUrl = urlInput;
                if (!urlInput.match(/^https?:\/\//)) {
                    processedUrl = 'https://' + urlInput;
                }
                
                const url = new URL(processedUrl);
                
                
                // Build results HTML
                let resultsHTML = '';
                
                // Protocol
                resultsHTML += `
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-medium text-gray-700 mb-2">Protocol</h3>
                        <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.protocol.replace(':', '')}', 'Protocol')">${url.protocol.replace(':', '')}</p>
                        <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                    </div>
                `;
                
                // Username and Password (if exists)
                if (url.username || url.password) {
                    if (url.username) {
                        resultsHTML += `
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h3 class="text-lg font-medium text-gray-700 mb-2">Username</h3>
                                <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.username}', 'Username')">${url.username}</p>
                                <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                            </div>
                        `;
                    }
                    if (url.password) {
                        resultsHTML += `
                            <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                                <h3 class="text-lg font-medium text-gray-700 mb-2">Password</h3>
                                <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.password}', 'Password')">${url.password}</p>
                                <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                            </div>
                        `;
                    }
                }
                
                // Hostname
                resultsHTML += `
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-medium text-gray-700 mb-2">Hostname</h3>
                        <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.hostname}', 'Hostname')">${url.hostname}</p>
                        <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                    </div>
                `;
                
                // Origin (protocol + hostname + port)
                resultsHTML += `
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-medium text-gray-700 mb-2">Origin</h3>
                        <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.origin}', 'Origin')">${url.origin}</p>
                        <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                    </div>
                `;
                
                // Port (if exists)
                if (url.port) {
                    resultsHTML += `
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Port</h3>
                            <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.port}', 'Port')">${url.port}</p>
                            <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                        </div>
                    `;
                }
                
                // Pathname
                resultsHTML += `
                    <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                        <h3 class="text-lg font-medium text-gray-700 mb-2">Path</h3>
                        <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.pathname || '/'}', 'Path')">${url.pathname || '/'}</p>
                        <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                    </div>
                `;
                
                // Query Parameters
                if (url.search) {
                    const searchParams = new URLSearchParams(url.search);
                    let queryHTML = '';
                    searchParams.forEach((value, key) => {
                        queryHTML += `
                            <div class="bg-white p-4 rounded-lg border-2 border-blue-200 hover:border-blue-400 hover:shadow-md transition-all duration-200">
                                <div class="flex items-center justify-between">
                                    <div class="flex-1">
                                        <div class="flex items-center mb-2">
                                            <span class="font-bold text-blue-800 text-xl">${key}</span>
                                            <span class="text-gray-400 mx-3 text-lg">:</span>
                                        </div>
                                        <div class="bg-gray-50 p-3 rounded border border-gray-200">
                                            <span class="text-gray-800 font-mono text-base break-all cursor-pointer hover:text-blue-600 transition-colors" onclick="copyToClipboard('${value}', 'Query Value: ${key}')">${value}</span>
                                        </div>
                                    </div>
                                    <div class="ml-4 flex flex-col gap-2">
                                        <button onclick="copyToClipboard('${key}', 'Query Key: ${key}')" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded text-sm font-medium transition-colors">
                                            Copy Key
                                        </button>
                                        <button onclick="copyToClipboard('${value}', 'Query Value: ${key}')" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-2 rounded text-sm font-medium transition-colors">
                                            Copy Value
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    
                    resultsHTML += `
                        <div class="col-span-full bg-gradient-to-r from-blue-50 to-indigo-50 p-6 rounded-lg border-2 border-blue-300 shadow-md">
                            <h3 class="text-2xl font-bold text-blue-900 mb-4 flex items-center">
                                <svg class="w-7 h-7 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                </svg>
                                Query Parameters (${searchParams.size})
                            </h3>
                            
                            <!-- Raw Query String -->
                            <div class="bg-white p-4 rounded border border-blue-200 mb-4">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm font-medium text-blue-700">Raw Query String:</span>
                                    <button onclick="copyToClipboard('${url.search}', 'Raw Query String')" class="bg-blue-100 hover:bg-blue-200 text-blue-700 px-3 py-1 rounded text-xs font-medium transition-colors">
                                        Copy Raw
                                    </button>
                                </div>
                                <p class="text-gray-800 font-mono text-sm break-all bg-gray-50 p-2 rounded">${url.search}</p>
                            </div>
                            
                            <!-- Individual Parameters -->
                            <div class="space-y-3">${queryHTML}</div>
                        </div>
                    `;
                } else {
                    resultsHTML += `
                        <div class="col-span-full bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Query Parameters</h3>
                            <p class="text-gray-500 italic">None</p>
                         </div>
                    `;
                }
                
                // Fragment
                if (url.hash) {
                    resultsHTML += `
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Fragment</h3>
                            <p class="text-gray-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.hash.replace('#', '')}', 'Fragment')">${url.hash.replace('#', '')}</p>
                            <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                        </div>
                    `;
                } else {
                    resultsHTML += `
                        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Fragment</h3>
                            <p class="text-gray-500 italic">None</p>
                        </div>
                    `;
                }
                
                // Full URL
                resultsHTML += `
                    <div class="col-span-full bg-blue-50 p-4 rounded-lg border border-blue-200">
                        <h3 class="text-lg font-medium text-blue-700 mb-2">Full URL</h3>
                        <p class="text-blue-900 font-mono text-sm break-all cursor-pointer" onclick="copyToClipboard('${url.href}', 'Full URL')">${url.href}</p>
                        <div class="text-xs text-blue-600 mt-2">Click to copy</div>
                    </div>
                `;
                
                
                resultsContainer.innerHTML = resultsHTML;
                showMessage('URL breakdown complete!', 'success');
            } catch (error) {
                showMessage(`Invalid URL: ${error.message}`, 'error');
                resultsContainer.innerHTML = '<div class="col-span-full text-center text-red-500 italic">Invalid URL format</div>';
            }
        }

        // Keyboard navigation for tabs
        function handleTabKeydown(event) {
            const tabs = Array.from(document.querySelectorAll('.tab-button'));
            const currentIndex = tabs.indexOf(event.target);
            let newIndex = currentIndex;
            
            switch(event.key) {
                case 'ArrowLeft':
                    newIndex = currentIndex > 0 ? currentIndex - 1 : tabs.length - 1;
                    break;
                case 'ArrowRight':
                    newIndex = currentIndex < tabs.length - 1 ? currentIndex + 1 : 0;
                    break;
                case 'Home':
                    newIndex = 0;
                    break;
                case 'End':
                    newIndex = tabs.length - 1;
                    break;
                default:
                    return;
            }
            
            event.preventDefault();
            tabs[newIndex].focus();
            const tabName = tabs[newIndex].id.replace('-tab', '');
            switchTab(tabName);
        }
        
        // Add keyboard event listeners to tabs
        function setupTabNavigation() {
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.addEventListener('keydown', handleTabKeydown);
            });
        }

        // Initialize the app
        window.addEventListener('load', () => {
            setupDragAndDrop();
            setupAnalyticsDragAndDrop();
            setupTabNavigation();
            // Initialize case converter with empty state
            convertCases();
            // Initialize URL breakdown with empty state
            breakdownURL();
        });
    </script>
</body>
</html>